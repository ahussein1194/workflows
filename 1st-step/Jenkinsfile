pipeline {
  agent {
      label 'lxplus'
  }
  stages {
    stage('Initialization') {
      steps {
        dir('1st-step') {
          mattermostSend (
		color: "#2A42EE",
	 	message: "Build STARTED: ${env.JOB_NAME} ${env.BUILD_DISPLAY_NAME} (<${env.BUILD_URL}|Link to build>)"
	  )
        }
      }
    }
    stage('Submit to condor') {
      steps {
	dir('1st-step') {
	  script {
	     sh "./submit_condor.sh"
	 }
      	}
      }
    }
  }

 post {
        success {
            script {
                // Send a Mattermost notification when the build succeeds.
                mattermostSend(
                    color: '#00FF00',
                    message: "Build SUCCESS: ${env.JOB_NAME} #${env.BUILD_DISPLAY_NAME} (<${env.BUILD_URL}|Link to build>)"
                )
            }
        }
        
        failure {
            script {
                // Send a Mattermost notification when the build fails.
                mattermostSend(
                    color: '#FF5733',
                    message: "Build FAILED: ${env.JOB_NAME} #${env.BUILD_DISPLAY_NAME} (<${env.BUILD_URL}|Link to build>)"
                )
            }
        }
    }
}
